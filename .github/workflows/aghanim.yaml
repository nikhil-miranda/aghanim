name: Read and Print Yaml File

on:
  push:
    branches:
      - main

jobs:
  read-json:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Read and Print YAML File
      id: read-yaml
      run: |
        # Read the contents of ./build/pepperx/destination.yaml
        yaml_content=$(cat build/pepperx/destination.yaml)
        
        # Use yq to extract the value of the "environment" key
        environment_value=$(echo "$yaml_content" | yq e '.environment' -)
        
        # Set the environment_value as an environment variable for this step
        echo "Environment Value:"
        echo "ENVIRONMENT_VALUE=$environment_value" >> $GITHUB_ENV

    - name: Make a Curl Call
      run: |
        # Access the environment_value from the environment variable
        environment_value="${{ env.ENVIRONMENT_VALUE }}"
        echo "Environment Value:"
        echo "$environment_value"
        
        # Now you can use $environment_value in your curl call
        # Replace the following line with your actual curl command
        curl -X GET "https://hunter.nikhilmiranda.com"